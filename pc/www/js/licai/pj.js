"use strict";new Vue({el:"#APP",delimiters:["${","}"],data:function data(){return{product:null,hislist:[],page:1,total:0,paramType:0,hislist1:[]}},mounted:function mounted(){T.setNavCurrent("pj");this.setNavTab();this.setTab();this.setHisTab();this.getHistory();this.tips();new Vue({el:".ProductStatus"})},filters:{toLocaleString:function toLocaleString(n){return T.format_number(n)}},methods:{goTop:function goTop(){T.goTop()},detail:function detail(item){window.location.href="/billDetail/pjDetal_html_"+item.id+".html"},getList:function getList(obj){var self=this;T.ajax({url:"/productList",data:obj,success:function success(data){self.hislist1=data.map.page.rows;self.hislist=data.map.page.rows;self.total=data.map.page.total;$.each(self.hislist,function(i,ele){var id=$("#"+ele.id);if(id.length){id.remove()}});self.$nextTick(function(){var effect=$(".history-list .effect"),option=$(".history-list .option");option.each(function(i,ele){if($(ele).css("display")=="block"){effect.height($(ele).height());$(ele).removeClass("cur").addClass("hover");setTimeout(function(){$(ele).css({display:"none"})},350)}else{$(ele).css({display:"block",position:"relative"});effect.height($(ele).height());$(ele).removeAttr("style");setTimeout(function(){$(ele).css({display:"block"}).addClass("hover");setTimeout(function(){$(ele).addClass("cur");setTimeout(function(){$(ele).removeClass("hover");effect.height("auto")},350)},50)},100)}})});self.pageChange(obj)}})},getHistory:function getHistory(){this.getList({order:0,pageOn:this.page,pageSize:5,paramType:this.paramType,statuses:[6,8,9]})},pageChange:function pageChange(obj){var self=this;layui.use(["laypage","layer"],function(){var laypage=layui.laypage;laypage.render({elem:"Page",limit:5,curr:self.page,count:self.total,layout:["prev","page","next","count"],jump:function jump(_obj,first){if(!first){self.page=_obj.curr;obj.pageOn=self.page;self.getList(obj)}}})})},setHisTab:function setHisTab(){var self=this,tag=$(".history-list .sort li");tag.each(function(i,li){li.tabClick=0;if(i==0){li.tabs=[0,0]}if(i==1){li.tabs=[1,2]}if(i==2){li.tabs=[3,4]}li.onclick=function(){var selfLi=this;if(selfLi.className.indexOf("cur")>-1&&i==0)return;tag.removeClass("cur up down");$(this).addClass("cur");if(selfLi.tabClick==0){selfLi.tabClick=1;$(this).addClass("up")}else{selfLi.tabClick=0;$(this).addClass("down")}self.getList({order:selfLi.tabs[selfLi.tabClick],pageOn:self.page,pageSize:5,paramType:self.paramType,statuses:[6,8,9]})}})},setNavTab:function setNavTab(){var self=this,effect=$(".options"),option=$("#APP .container"),tag=$("#APP .nav li");tag.each(function(i,li){li.onclick=function(){var selfLi=this;self.paramType=[0,2,5][i];self.getHistory();if(selfLi.className.indexOf("current")>-1)return;tag.removeClass("current");$(selfLi).addClass("current");option.each(function(j,ele){if($(ele).css("display")=="block"){effect.height($(ele).height());$(ele).removeClass("cur").addClass("hover");setTimeout(function(){$(ele).css({display:"none"})},350)}if(j==i){$(ele).css({display:"block"}).addClass("hover");setTimeout(function(){$(ele).addClass("cur");setTimeout(function(){$(ele).removeClass("hover");effect.height("auto")},350)},50)}})}})},setTab:function setTab(){$(".container").each(function(l,container){var effect=$(container).find(".allProduct"),option=$(container).find(".allProduct .option"),tag=$(container).find(".top .screen .sort li");tag.each(function(i,li){li.tabClick=0;if(i==0){li.tabs=[0,0]}if(i==1){li.tabs=[1,2]}if(i==2){li.tabs=[3,4]}li.onclick=function(){var selfLi=this;if(selfLi.className.indexOf("cur")>-1&&i==0)return;tag.removeClass("cur up down");$(this).addClass("cur");if(selfLi.tabClick==0){selfLi.tabClick=1;$(this).addClass("up")}else{selfLi.tabClick=0;$(this).addClass("down")}option.each(function(j,ele){if($(ele).css("display")=="block"){if($(ele).height()>100){effect.height($(ele).height())}$(ele).removeClass("cur").addClass("hover");setTimeout(function(){$(ele).css({display:"none"})},350)}if(j==selfLi.tabs[selfLi.tabClick]){setTimeout(function(){$(ele).css({display:"block"}).addClass("hover");setTimeout(function(){$(ele).addClass("cur");setTimeout(function(){$(ele).removeClass("hover");effect.height("auto")},350)},50)},100)}})}})})},tips:function tips(){layui.use("layer",function(){var layer=layui.layer,index;$(".allProduct .tag-tips").each(function(){$(this).mouseover(function(){$(this).addClass("currentTips");index=layer.tips($(this).attr("data-tips"),".currentTips",{tips:1,skin:"tips",time:0})}).mouseleave(function(){layer.close(index);$(this).removeClass("currentTips")})})})}}});